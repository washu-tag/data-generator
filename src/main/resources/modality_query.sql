SELECT obr_24_diagnostic_serv_sect_id as primary_modality, COUNT(CASE WHEN pid_8_administrative_sex='M' THEN 1 END) as male_count, COUNT(CASE WHEN pid_8_administrative_sex='F' THEN 1 END) as female_count, COUNT(*) as total_count FROM syntheticdata WHERE msh_12_version_id='2.7' GROUP BY obr_24_diagnostic_serv_sect_id ORDER BY obr_24_diagnostic_serv_sect_id